import{$ as U,ay as W,A as p,a2 as _,aT as X,v as a,I as c,bp as z,h as G,cp as P,by as J,cV as V,z as q,q as H,J as K,t as j,cW as Q,aS as Z}from"./index.20ecd292.js";const ee=""+new URL("resume.6e209205.svg",import.meta.url).href,te=""+new URL("p-rotate.1d232189.svg",import.meta.url).href,ne=""+new URL("scale.8d8ebde4.svg",import.meta.url).href,le=""+new URL("unscale.99ad049c.svg",import.meta.url).href,ae=""+new URL("unrotate.f9dd5a27.svg",import.meta.url).href;var f;(function(n){n[n.LOADING=0]="LOADING",n[n.DONE=1]="DONE",n[n.FAIL=2]="FAIL"})(f||(f={}));const ie={show:{type:Boolean,default:!1},imageList:{type:[Array],default:null},index:{type:Number,default:0},scaleStep:{type:Number},defaultWidth:{type:Number},maskClosable:{type:Boolean},rememberState:{type:Boolean}},i="img-preview",se=U({name:"ImagePreview",props:ie,emits:["img-load","img-error"],setup(n,{expose:b,emit:$}){const d=new Map,t=W({currentUrl:"",imgScale:1,imgRotate:0,imgTop:0,imgLeft:0,status:f.LOADING,currentIndex:0,moveX:0,moveY:0,show:n.show}),o=p(null),r=p(null);function h(){m();const{index:e,imageList:l}=n;if(!l||!l.length)throw new Error("imageList is undefined");t.currentIndex=e,L(l[e])}function x(){t.imgScale=1,t.imgRotate=0,t.imgTop=0,t.imgLeft=0}function m(){const e=c(o);!e||(e.onmousewheel=y,document.body.addEventListener("DOMMouseScroll",y),document.ondragstart=function(){return!1})}const v=_(()=>{var l;const e=(l=n==null?void 0:n.scaleStep)!=null?l:0;return(e!=null?e:0>0)?e/100:t.imgScale/10});function y(e){e=e||window.event,e.delta=e.wheelDelta||-e.detail,e.preventDefault(),e.delta>0&&g(v.value),e.delta<0&&g(-v.value)}function g(e){t.imgScale<=.2&&e<0||(t.imgScale+=e)}function w(e){t.imgRotate+=e}function S(){const e=c(r);!e||(e.onmousemove=null)}function L(e){t.status=f.LOADING;const l=new Image;l.src=e,l.onload=s=>{if(t.currentUrl!==e){const u=s.composedPath();if(n.rememberState){d.set(t.currentUrl,{scale:t.imgScale,top:t.imgTop,left:t.imgLeft,rotate:t.imgRotate});const I=d.get(e);I?(t.imgScale=I.scale,t.imgTop=I.top,t.imgRotate=I.rotate,t.imgLeft=I.left):(x(),n.defaultWidth&&(t.imgScale=n.defaultWidth/u[0].naturalWidth))}else n.defaultWidth&&(t.imgScale=n.defaultWidth/u[0].naturalWidth);u&&$("img-load",{index:t.currentIndex,dom:u[0],url:e})}t.currentUrl=e,t.status=f.DONE},l.onerror=s=>{const u=s.composedPath();u&&$("img-error",{index:t.currentIndex,dom:u[0],url:e}),t.status=f.FAIL}}function C(e){e&&e.stopPropagation(),D()}function D(){t.show=!1,document.body.removeEventListener("DOMMouseScroll",y),document.ondragstart=null}function M(){x()}b({resume:M,close:D,prev:R.bind(null,"left"),next:R.bind(null,"right"),setScale:e=>{e>0&&e<=10&&(t.imgScale=e)},setRotate:e=>{t.imgRotate=e}});function R(e){const{currentIndex:l}=t,{imageList:s}=n;e==="left"&&(t.currentIndex--,l<=0&&(t.currentIndex=s.length-1)),e==="right"&&(t.currentIndex++,l>=s.length-1&&(t.currentIndex=0)),L(s[t.currentIndex])}function A(e){e=e||window.event,t.moveX=e.clientX,t.moveY=e.clientY;const l=c(r);l&&(l.onmousemove=N)}function N(e){e=e||window.event,e.preventDefault();const l=e.clientX-t.moveX,s=e.clientY-t.moveY;t.imgLeft+=l,t.imgTop+=s,t.moveX=e.clientX,t.moveY=e.clientY}const Y=_(()=>{const{imgScale:e,imgRotate:l,imgTop:s,imgLeft:u}=t;return{transform:`scale(${e}) rotate(${l}deg)`,marginTop:`${s}px`,marginLeft:`${u}px`,maxWidth:n.defaultWidth?"unset":"100%"}}),k=_(()=>{const{imageList:e}=n;return e.length>1});X(()=>{n.show&&h(),n.imageList&&x()});const B=e=>{n.maskClosable&&e.target&&e.target.classList.contains(`${i}-content`)&&C(e)},E=()=>a("div",{class:`${i}__close`,onClick:C},[a(z,{class:`${i}__close-icon`},null)]),F=()=>{if(!c(k))return null;const{currentIndex:e}=t,{imageList:l}=n;return a("div",{class:`${i}__index`},[e+1,G(" / "),l.length])},T=()=>a("div",{class:`${i}__controller`},[a("div",{class:`${i}__controller-item`,onClick:()=>g(-v.value)},[a("img",{src:le},null)]),a("div",{class:`${i}__controller-item`,onClick:()=>g(v.value)},[a("img",{src:ne},null)]),a("div",{class:`${i}__controller-item`,onClick:M},[a("img",{src:ee},null)]),a("div",{class:`${i}__controller-item`,onClick:()=>w(-90)},[a("img",{src:ae},null)]),a("div",{class:`${i}__controller-item`,onClick:()=>w(90)},[a("img",{src:te},null)])]),O=e=>c(k)?a("div",{class:[`${i}__arrow`,e],onClick:()=>R(e)},[e==="left"?a(P,null,null):a(J,null,null)]):null;return()=>t.show&&a("div",{class:i,ref:o,onMouseup:S,onClick:B},[a("div",{class:`${i}-content`},[a("img",{style:c(Y),class:[`${i}-image`,t.status===f.DONE?"":"hidden"],ref:r,src:t.currentUrl,onMousedown:A},null),E(),F(),T(),O("left"),O("right")])])}});const ce=U({name:"UseDraggable",props:["position","handle","lockBoundary","boundary"],setup(n,{slots:b,emit:$}){const d=p(),t=_(()=>{var m;return(m=n.handle)!=null?m:d.value}),o=V(d,{handle:t,initialValue:_(()=>n.position?{x:n.position[0],y:n.position[1]}:{x:0,y:0})}),r=p({x:0,y:0,width:0,height:0}),h=()=>{r.value=n.boundary.getBoundingClientRect()};q(h),H(n.boundary,h),K(()=>j(n.boundary,h)),Q();const x=_(()=>{var S,L;if(n.lockBoundary||`${o.x.value}${o.y.value}`,!c(d))return`top:${o.x.value}px;left:${o.y.value}px`;const m=(S=c(d))==null?void 0:S.getBoundingClientRect(),v=(L=c(m))==null?void 0:L.width,y=c(m).height,g=Math.min(Math.max(r.value.x,o.x.value),r.value.width-v),w=Math.min(Math.max(r.value.y,o.y.value),r.value.height-y);return o.x.value=g,o.y.value=w,`top:${w}px;left:${g}px`});return()=>{if(b.default)return Z(n.as||"div",{ref:d,style:`touch-action:none;${c(x)}`},b.default(W(o)))}}});export{ce as U,se as _};
//# sourceMappingURL=ClickOutSide.vue_vue_type_style_index_0_scoped_edbeaf5e_lang.4a88cdb0.js.map
